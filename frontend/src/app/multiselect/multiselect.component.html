<div class="border border-gray-500 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 px-4 py-2 relative"
    tabindex="0" (click)="toggleOptions()">
    <div *ngIf="selectedItems.length === 0">{{placeholder}}</div>
    <button *ngFor="let item of selectedItems" type="button" (click)="onButtonClick($event, item)"
        class="bg-blue-500 py-1 px-2 mr-2 rounded text-sm">{{item}}</button>

    <svg class="absolute right-1 top-2" [ngClass]="showOptions ? 'rotate-180': 'rotate-0'"
        xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#666666"
        stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M6 9l6 6 6-6" />
    </svg>

    <div (click)="onOptionClick($event)"
        class="absolute border border-black px-4 py-2 top-11 left-0 w-full bg-white max-h-64 overflow-y-auto z-10"
        [ngClass]="showOptions ? 'block': 'hidden'">
        <div class="flex flex-col">
            <input #search (input)="onSearchInput(search.value)" type="text" placeholder="Search..." class="w-full">
            <button type="button" (click)="onClearClick()" class="py-1 px-2 border border-gray-500 rounded bg-gray-200 mt-2 mr-auto">Clear selection</button>
        </div>

        <ng-container *ngIf="filteredOptions; else allOptions">
            <div *ngFor="let option of filteredOptions">
                <input (click)="onItemSelect($event.target)" type="checkbox" [id]="option"
                    [checked]="optionInSelectedOptions(option)"><label [for]="option" class="ml-2">{{option}}</label>
            </div>
        </ng-container>
        <ng-template #allOptions>
            <div *ngFor="let option of options">
                <input (click)="onItemSelect($event.target)" type="checkbox" [id]="option"
                    [checked]="optionInSelectedOptions(option)"><label [for]="option" class="ml-2">{{option}}</label>
            </div>
        </ng-template>

    </div>

</div>